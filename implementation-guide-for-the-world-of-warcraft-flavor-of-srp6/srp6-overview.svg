<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="721px" preserveAspectRatio="none" style="width:470px;height:721px;background:#FFFFFF;" version="1.1" viewBox="0 0 470 721" width="470px" zoomAndPan="magnify"><defs><filter height="300%" id="f10rkutpkhxtgq" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="150.5" x2="150.5" y1="40.2969" y2="678.0859"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="289" x2="289" y1="40.2969" y2="678.0859"/><rect fill="#FEFECE" filter="url(#f10rkutpkhxtgq)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="53" x="122.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="129.5" y="24.9951">Client</text><rect fill="#FEFECE" filter="url(#f10rkutpkhxtgq)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="53" x="122.5" y="677.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="129.5" y="697.0811">Client</text><rect fill="#FEFECE" filter="url(#f10rkutpkhxtgq)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="58" x="258" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="265" y="24.9951">Server</text><rect fill="#FEFECE" filter="url(#f10rkutpkhxtgq)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="58" x="258" y="677.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="265" y="697.0811">Server</text><polygon fill="#A80036" points="277,67.4297,287,71.4297,277,75.4297,281,71.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="151" x2="283" y1="71.4297" y2="71.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="158" y="66.3638">Username</text><line style="stroke:#A80036;stroke-width:1.0;" x1="289" x2="331" y1="115.6953" y2="115.6953"/><line style="stroke:#A80036;stroke-width:1.0;" x1="331" x2="331" y1="115.6953" y2="128.6953"/><line style="stroke:#A80036;stroke-width:1.0;" x1="290" x2="331" y1="128.6953" y2="128.6953"/><polygon fill="#A80036" points="300,124.6953,290,128.6953,300,132.6953,296,128.6953" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="296" y="95.4966">Retrieve password verifier</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="296" y="110.6294">and salt</text><line style="stroke:#A80036;stroke-width:1.0;" x1="289" x2="331" y1="172.9609" y2="172.9609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="331" x2="331" y1="172.9609" y2="185.9609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="290" x2="331" y1="185.9609" y2="185.9609"/><polygon fill="#A80036" points="300,181.9609,290,185.9609,300,189.9609,296,185.9609" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="296" y="152.7622">Generate private</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="296" y="167.895">and public key</text><polygon fill="#A80036" points="162,256.4922,152,260.4922,162,264.4922,158,260.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="156" x2="288" y1="260.4922" y2="260.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="168" y="210.0278">Server public key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="168" y="225.1606">salt,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="168" y="240.2935">large safe prime,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="168" y="255.4263">generator</text><line style="stroke:#A80036;stroke-width:1.0;" x1="109" x2="151" y1="304.7578" y2="304.7578"/><line style="stroke:#A80036;stroke-width:1.0;" x1="109" x2="109" y1="304.7578" y2="317.7578"/><line style="stroke:#A80036;stroke-width:1.0;" x1="109" x2="150" y1="317.7578" y2="317.7578"/><polygon fill="#A80036" points="142,313.7578,152,317.7578,142,321.7578,146,317.7578" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="39" y="284.5591">Generate private</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="39" y="299.6919">and public key</text><line style="stroke:#A80036;stroke-width:1.0;" x1="109" x2="151" y1="346.8906" y2="346.8906"/><line style="stroke:#A80036;stroke-width:1.0;" x1="109" x2="109" y1="346.8906" y2="359.8906"/><line style="stroke:#A80036;stroke-width:1.0;" x1="109" x2="150" y1="359.8906" y2="359.8906"/><polygon fill="#A80036" points="142,355.8906,152,359.8906,142,363.8906,146,359.8906" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="14" y="341.8247">Calculate session key</text><line style="stroke:#A80036;stroke-width:1.0;" x1="109" x2="151" y1="389.0234" y2="389.0234"/><line style="stroke:#A80036;stroke-width:1.0;" x1="109" x2="109" y1="389.0234" y2="402.0234"/><line style="stroke:#A80036;stroke-width:1.0;" x1="109" x2="150" y1="402.0234" y2="402.0234"/><polygon fill="#A80036" points="142,398.0234,152,402.0234,142,406.0234,146,402.0234" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="17" y="383.9575">Calculate client proof</text><polygon fill="#A80036" points="277,442.2891,287,446.2891,277,450.2891,281,446.2891" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="151" x2="283" y1="446.2891" y2="446.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="158" y="426.0903">Client public key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="158" y="441.2231">client proof</text><line style="stroke:#A80036;stroke-width:1.0;" x1="289" x2="331" y1="475.4219" y2="475.4219"/><line style="stroke:#A80036;stroke-width:1.0;" x1="331" x2="331" y1="475.4219" y2="488.4219"/><line style="stroke:#A80036;stroke-width:1.0;" x1="290" x2="331" y1="488.4219" y2="488.4219"/><polygon fill="#A80036" points="300,484.4219,290,488.4219,300,492.4219,296,488.4219" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="296" y="470.356">Calculate session key</text><line style="stroke:#A80036;stroke-width:1.0;" x1="289" x2="331" y1="517.5547" y2="517.5547"/><line style="stroke:#A80036;stroke-width:1.0;" x1="331" x2="331" y1="517.5547" y2="530.5547"/><line style="stroke:#A80036;stroke-width:1.0;" x1="290" x2="331" y1="530.5547" y2="530.5547"/><polygon fill="#A80036" points="300,526.5547,290,530.5547,300,534.5547,296,530.5547" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="296" y="512.4888">Verify client proof</text><polygon fill="#A80036" points="162,555.6875,152,559.6875,162,563.6875,158,559.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="156" x2="288" y1="559.6875" y2="559.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="168" y="554.6216">Send server proof</text><line style="stroke:#A80036;stroke-width:1.0;" x1="109" x2="151" y1="588.8203" y2="588.8203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="109" x2="109" y1="588.8203" y2="601.8203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="109" x2="150" y1="601.8203" y2="601.8203"/><polygon fill="#A80036" points="142,597.8203,152,601.8203,142,605.8203,146,601.8203" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="34" y="583.7544">Verify server proof</text><polygon fill="#A80036" points="277,626.9531,287,630.9531,277,634.9531,281,630.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="151" x2="283" y1="630.9531" y2="630.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="158" y="625.8872">'Send Realmlist'</text><polygon fill="#A80036" points="162,656.0859,152,660.0859,162,664.0859,158,660.0859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="156" x2="288" y1="660.0859" y2="660.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="168" y="655.02">Realmlist</text><!--MD5=[a7766310ae2393da9ca3a5723ab0c38c]
@startuml
Client -> Server: Username

Server -> Server: Retrieve password verifier \nand salt
Server -> Server: Generate private \nand public key

Server -> Client: Server public key,\nsalt, \nlarge safe prime,\ngenerator

Client <- Client: Generate private \nand public key
Client <- Client: Calculate session key
Client <- Client: Calculate client proof

Client -> Server: Client public key,\nclient proof

Server -> Server: Calculate session key
Server -> Server: Verify client proof

Server -> Client: Send server proof

Client <- Client: Verify server proof
Client -> Server: 'Send Realmlist'
Server -> Client: Realmlist
@enduml

PlantUML version 1.2021.7(Sun May 23 14:40:07 CEST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>